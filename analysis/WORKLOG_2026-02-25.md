# Worklog - 2026-02-25

## Scope
Empirical finance panel analysis using `data/df_regression.csv`, including baseline FE regressions, recession heterogeneity, cycle-separated estimation, time-varying beta plots, and combined business-cycle x size analysis.

## 1) Baseline Panel OLS (FE)
- Built reproducible script: `analysis/base_penel/baseline_panel_ols.py`
- Spec: two-way FE (`cusip` + `date`), controls `c_firm_size`, `c_dollar_vol`, two-way clustered SE.
- Outcomes: `amihud_illiq`, `volatility`, `price_info`.
- Main outputs:
  - `analysis/base_penel/panel_results_controls.csv`
  - `analysis/base_penel/panel_results_controls_detailed.csv`
  - `analysis/base_penel/panel_results_controls.tex`
  - `analysis/base_penel/panel_results_controls_pretty.tex`
- Data handling fix: filtered non-finite values (notably `price_info` had `inf`) before estimation.

## 2) Interpretation + Stats Table + Coefficient Plot
- Added post-estimation reporting script: `analysis/base_penel/post_baseline_outputs.py`
- Generated:
  - Inference table: `analysis/base_penel/panel_results_inference_stats.csv`
  - LaTeX table: `analysis/base_penel/panel_results_inference_stats.tex`
  - Interpretation note: `analysis/base_penel/baseline_interpretation.md`
  - Plot: `analysis/base_penel/panel_coefficients_95ci.svg`

## 3) Recession Interaction Heterogeneity
- Implemented interaction model script:
  - `analysis/base_penel/recession_interaction_panel.py`
- Recession windows used:
  - `2001Q1-2001Q4`, `2007Q4-2009Q2`, `2019Q4-2020Q2`
- Model includes `ind_own x recession` interaction with same FE + clustering setup.
- Outputs:
  - `analysis/base_penel/panel_recession_interaction_detailed.csv`
  - `analysis/base_penel/panel_recession_interaction_summary.csv`
  - `analysis/base_penel/panel_recession_interaction_pretty.tex`

## 4) Cycle-Separated Regressions + Plots
- Added script: `analysis/business_cycle/cycle_separated_panel.py`
- Estimated separate FE models by cycle block:
  - `1993Q1-2000Q4`, `2001Q1-2001Q4`, `2002Q1-2007Q3`, `2007Q4-2009Q2`, `2009Q3-2019Q3`, `2019Q4-2020Q2`, `2020Q3-2023Q4`
- Outputs:
  - `analysis/business_cycle/panel_cycle_separated_detailed.csv`
  - `analysis/business_cycle/panel_cycle_separated_summary.csv`
  - `analysis/business_cycle/panel_cycle_separated_pretty.tex`
  - `analysis/business_cycle/ind_own_coef_across_cycles.svg`
  - `analysis/business_cycle/ind_own_coef_across_cycles_timeaxis.svg`
- Plot updates requested and completed:
  - Recession shading (light blue) added to both cycle plot and time-axis plot.

## 5) Time-Varying Beta Plots (Separate per DV)
- Added rolling-window script: `analysis/business_cycle/plot_beta_over_time.py`
- Method: rolling 16-quarter FE regressions; plotted beta(`ind_own`) + 95% CI.
- Recession shading in light blue included.
- Outputs:
  - `analysis/business_cycle/beta_over_time_rolling_window.csv`
  - `analysis/business_cycle/beta_over_time_amihud_illiq.svg`
  - `analysis/business_cycle/beta_over_time_volatility.svg`
  - `analysis/business_cycle/beta_over_time_price_info.svg`
- Legend revision completed for all three plots:
  - changed `Beta on ind_own` -> `Beta`

## 6) Combined Business-Cycle x Size Analysis
- Implemented combined heterogeneity script:
  - `analysis/business_cycle/cycle_size_combined_panel.py`
- Method:
  - Size deciles from observation-level `mktcap` (`pd.qcut`, 10 bins)
  - FE regressions within each `cycle x size_decile x dep_var` cell
  - Ranked significant cells by score `|t| * log(1+N)`
- Outputs:
  - `analysis/business_cycle/panel_cycle_size_detailed.csv`
  - `analysis/business_cycle/panel_cycle_size_best_results.csv`
  - `analysis/business_cycle/panel_cycle_size_best_summary.md`
  - `analysis/business_cycle/heatmap_t_indown_cycle_size_amihud_illiq.svg`
  - `analysis/business_cycle/heatmap_t_indown_cycle_size_volatility.svg`
  - `analysis/business_cycle/heatmap_t_indown_cycle_size_price_info.svg`

## Best Combined Results (robust subset, N >= 1000)
- `amihud_illiq`: `exp_2002Q1_2007Q3`, decile 7, beta = 0.0348, t = 3.58, p = 0.000346
- `volatility`: `exp_2020Q3_2023Q4`, decile 9, beta = -0.2146, t = -2.91, p = 0.00359
- `price_info`: `exp_2009Q3_2019Q3`, decile 4, beta = -18.0537, t = -9.04, p < 1e-15

## Notes
- All main regressions kept a consistent identification setup: firm FE + time FE with two-way clustered SE.
- Multiple plotting and reporting scripts were added to make results fully reproducible from code.
